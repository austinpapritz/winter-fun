<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- metadata -->
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />

        <!-- title and favicon -->
        <title>Web App</title>

        <!-- js -->
        <script type="module" src="app.js"></script>

        <!-- fonts -->
        <!-- see https://fonts.google.com/ -->

        <!-- css -->
        <link rel="stylesheet" href="styles/reset.css" />
        <link rel="stylesheet" href="styles/global.css" />
        <!-- add link for page specific css -->
        <script>
            let calcArr = [];

            //BUG: second operator click displays operator. Must change setting tossIfFirstNotNum to 'o'

            function tossIfFirstNotNum(n) {
                if ((n === '/' || n === '-' || n === '+' || n === '*') && calcArr.length === 0) {
                    return;
                } else {
                    return n;
                }
            }

            function compareNAndPenultimateItem(n) {
                //if n is operator then compare it to the penultimate item to either replace or add n to end
                if (n === '/' || n === '-' || n === '+' || n === '*') {
                    let penultimateItem = calcArr[calcArr.length - 2];
                    if (
                        penultimateItem === '/' ||
                        penultimateItem === '-' ||
                        penultimateItem === '+' ||
                        penultimateItem === '*'
                    ) {
                        //if the last item (besides the space) is an operator then replace it
                        replaceLast(n);
                    } else {
                        //if the penultimateItem isn't an operator then simply push n with spaces
                        calcArr.push(' ');
                        calcArr.push(n);
                        calcArr.push(' ');
                    }
                } else {
                    //if number then push to calcArr
                    calcArr.push(n);
                }
            }

            function replaceLast(newOperator) {
                calcArr[calcArr.length - 2] = newOperator;
            }

            function displayCalcArr() {
                //!isNan makes sure that user cannot start with operator
                if (!isNaN(calcArr[0])) {
                    //display the calcArr (with a space between values)
                    document.getElementById('result').value = calcArr.join('');
                } else {
                    //if the user did start with operator then clear calcArr
                    calcArr = [];
                }
            }

            function handleInput(n) {
                //if first input is an operator then toss, otherwise return n
                let o = tossIfFirstNotNum(n);
                //if both o and penultimate item are operators then replace penultimateItem with n
                compareNAndPenultimateItem(o);

                displayCalcArr();
            }

            function clearScreen() {
                calcArr = [];
                document.getElementById('result').value = '';
            }

            function calculate() {
                //set results to the evaluation of equation
                const results = calcArr.join('');
                document.getElementById('result').value = eval(results);
                //the follow replaces the previous calcArr with the answer of results so user can perform math on it
                calcArr = [];
                let newEquation = document.getElementById('result').value;
                calcArr.push(newEquation);
                displayCalcArr();
            }
        </script>
    </head>

    <body>
        <header>
            <h1>❄️Winter Fun❄️</h1>
        </header>

        <main>
            <p id="display-fib"></p>
            <p id="display-iter"></p>
            <hr />
            <table class="calculator">
                <tr>
                    <td colspan="3">
                        <input class="display-box" type="text" id="result" disabled />
                    </td>

                    <!-- clearScreen() function clears all the values -->

                    <td>
                        <input type="button" value="C" onclick="clearScreen()" id="clear-btn" />
                    </td>
                </tr>
                <tr>
                    <!-- displayCalc() function displays the value of clicked button -->

                    <td><input type="button" value="1" onclick="handleInput('1')" /></td>

                    <td><input type="button" value="2" onclick="handleInput('2')" /></td>

                    <td><input type="button" value="3" onclick="handleInput('3')" /></td>

                    <td><input type="button" value="/" onclick="handleInput('/')" /></td>
                </tr>
                <tr>
                    <td><input type="button" value="4" onclick="handleInput('4')" /></td>

                    <td><input type="button" value="5" onclick="handleInput('5')" /></td>

                    <td><input type="button" value="6" onclick="handleInput('6')" /></td>

                    <td><input type="button" value="-" onclick="handleInput('-')" /></td>
                </tr>
                <tr>
                    <td><input type="button" value="7" onclick="handleInput('7')" /></td>

                    <td><input type="button" value="8" onclick="handleInput('8')" /></td>

                    <td><input type="button" value="9" onclick="handleInput('9')" /></td>

                    <td><input type="button" value="+" onclick="handleInput('+')" /></td>
                </tr>
                <tr>
                    <td><input type="button" value="." onclick="handleInput('.')" /></td>

                    <td><input type="button" value="0" onclick="handleInput('0')" /></td>

                    <!-- calculate() function evaluates the mathematical expression -->

                    <td>
                        <input type="button" value="=" onclick="calculate()" id="equal-btn" />
                    </td>

                    <td><input type="button" value="*" onclick="handleInput('*')" /></td>
                </tr>
            </table>
            <hr />
            <!-- tabs experiment -->
            <h2>How to Tabs</h2>
            <div class="about-center section-center"></div>
            <article class="about">
                <!-- button container -->
                <div class="btn-container">
                    <button class="tab-btn" data-id="history">history</button>
                    <button class="tab-btn" data-id="vision">vision</button>
                    <button class="tab-btn" data-id="goals">goals</button>
                </div>

                <article class="about-content">
                    <!-- single item  -->
                    <div class="content active" id="history">
                        <h4>History</h4>
                        <!-- history -->
                        <p>
                            Hi, 4k player here who reported slahser. Slahser was our position 1
                            faceless void. He built a mek and had around 29 healing salves in his
                            inventory. He would chrono both teams in the middle of a fight, salve
                            his allies, pop mek, and proceeded to yell "SLAHSER'S WAY". We gave him
                            position 1 farm so he could be a position 5. Granted, his unorthodox
                            build worked and carried us to victory but I still felt it deserved a
                            report.
                        </p>
                    </div>
                    <!-- end of single item -->
                    <!-- single item  -->
                    <div class="content" id="vision">
                        <h4>Vision</h4>
                        <!-- vision -->
                        <p>
                            By the way guys, those aren't earbuds BSJ's using. BSJ has actual power
                            cables connected into his brain to suffice the energy consumption from
                            generating billions of simulation per second to determine the most
                            optimal play in his games of dota 2
                        </p>
                    </div>
                    <!-- end of single item -->
                    <!-- single item  -->
                    <div class="content" id="goals">
                        <h4>Goals</h4>
                        <!-- goals -->
                        <p>
                            PeoplesChamp YO PeoplesChamp DID PeoplesChamp HE PeoplesChamp JUST
                            PeoplesChamp WALK PeoplesChamp UP PeoplesChamp SLOWLY PeoplesChamp AND
                            PeoplesChamp DOWNSMASH PeoplesChamp
                        </p>
                        <ul>
                            <li>list item</li>
                            <li>list item</li>
                            <li>list item</li>
                        </ul>
                    </div>
                    <!-- end of single item -->
                </article>
            </article>
            <hr />
        </main>
    </body>
</html>
